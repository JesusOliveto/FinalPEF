@startuml
skinparam style strictuml
hide circle
skinparam classAttributeIconSize 0

' ==== Entidades principales (como clases) ====
entity Graph {
  -- representaci√≥n dirigida con lista de adyacencia --
}

entity Node {
  id : int
  lat : float
  lon : float
}

entity Edge {
  to : int
  distance_m : float
  road_class : RoadClass
  freeflow_kmh : float
  one_way : bool
}

entity RouteRequest {
  origin : int
  destinations : List<int>
  hour : int
  mode : RouteMode
  algorithm : Algorithm
}

entity RouteLeg {
  src : int
  dst : int
  path : List<int>
  seconds : float
  distance_m : float
  expanded_nodes : int
}

entity RouteResult {
  visit_order : List<int>
  total_seconds : float
  total_distance_m : float
  algorithm_summary : str
  cache_hits : int
  cache_misses : int
}

' ==== Lookups (enums del dominio) ====
entity RoadClass <<enum>> {
  RESIDENTIAL
  COLLECTOR
  PRIMARY
}

entity Algorithm <<enum>> {
  astar
  dijkstra
  bfs
}

entity RouteMode <<enum>> {
  visit_all_open
  visit_all_circuit
  fixed_order
}

' ==== Relaciones (cardinalidades) ====
Graph ||--o{ Node : contiene
Graph ||--o{ Edge : contiene

Edge }o--|| Node : from
Edge }o--|| Node : to

RoadClass ||--o{ Edge : clasifica

RouteResult ||--o{ RouteLeg : descompone

RouteLeg }o--|| Node : src
RouteLeg }o--|| Node : dst

RouteRequest ||--|| Node : origin
RouteRequest ||--o{ Node : destinos

Algorithm ||--o{ RouteRequest
RouteMode ||--o{ RouteRequest
@enduml
